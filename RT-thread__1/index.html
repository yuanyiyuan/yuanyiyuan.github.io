



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="天元の" href="https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="天元の" href="https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/atom.xml" />
<link rel="alternate" type="application/json" title="天元の" href="https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="RT-thread" />


<link rel="canonical" href="https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/RT-thread__1/">



  <title>
RT-thread__1 |
Tian yuan = 天元の = 宇宙中的每一粒尘埃都有着迷人的故事</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">RT-thread__1
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2021-07-12 22:07:18">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2021-07-12T22:07:18+08:00">2021-07-12</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Tian yuan</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipevarprfj20zk0m8npd.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipetv6p75j20zk0m8x6p.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicli3sbvtj20zk0m8x6p.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipewr8iypj20zk0m8b29.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclh0m9pdj20zk0m8hdt.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclg5ms2rj20zk0m8u0x.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/RT-thread__1/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="~元~">
    <meta itemprop="description" content="宇宙中的每一粒尘埃都有着迷人的故事, ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="天元の">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p>一. 内核基础</p>
<pre><code>    启动流程:
        系统启动后先从汇编代码 startup_stm32f103xe.s 开始运行，然后跳转到 C 代码，进行 RT-Thread 系统启动，最后进入用户程序入口函数 main()
            为了在进入 main() 之前完成 RT-Thread 系统功能初始化，我们使用了 MDK 的扩展功能 $Sub$$ 和 $Super$$
                    $Sub$$main   :  可以先调用一些要补充在 main 之前的功能函数
                    $Super$$main :  $Sub$$main 之后转到 main() 函数执行
            &lt;此将rtthread_startup();放入$Sub$$main里，进行系统一系列初始化&gt;
            <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">int rtthread_startup(void)</span><br><span class="line">&#123;</span><br><span class="line">    rt_hw_interrupt_disable();</span><br><span class="line"></span><br><span class="line">    /* 板级初始化：需在该函数内部进行系统堆的初始化 */</span><br><span class="line">    rt_hw_board_init();</span><br><span class="line"></span><br><span class="line">    /* 打印 RT-Thread 版本信息 */</span><br><span class="line">    rt_show_version();</span><br><span class="line"></span><br><span class="line">    /* 定时器初始化 */</span><br><span class="line">    rt_system_timer_init();</span><br><span class="line"></span><br><span class="line">    /* 调度器初始化 */</span><br><span class="line">    rt_system_scheduler_init();</span><br><span class="line"></span><br><span class="line">#ifdef RT_USING_SIGNALS</span><br><span class="line">    /* 信号初始化 */</span><br><span class="line">    rt_system_signal_init();</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">    /* 由此创建一个用户 main 线程 */</span><br><span class="line">    rt_application_init();</span><br><span class="line"></span><br><span class="line">    /* 定时器线程初始化 */</span><br><span class="line">    rt_system_timer_thread_init();</span><br><span class="line"></span><br><span class="line">    /* 空闲线程初始化 */</span><br><span class="line">    rt_thread_idle_init();</span><br><span class="line"></span><br><span class="line">    /* 启动调度器 */</span><br><span class="line">    rt_system_scheduler_start();</span><br><span class="line"></span><br><span class="line">    /* 不会执行至此 */</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            启动代码大致可以分为四个部分：
                （1）初始化与系统相关的硬件
                （2）初始化系统内核对象，例如定时器、调度器、信号
                （3）创建 main 线程，在 main 线程中对各类模块依次进行初始化
                （4）初始化定时器线程、空闲线程，并启动调度器
                [ 只有启动了调度器，系统才会转入第一个线程开始运行 ]
            main() 函数是 RT-Thread 的用户代码入口，用户可以在 main() 函数里添加自己的应用

    内存分布：
        MCU 包含的存储空间有：片内 Flash (硬盘) 与片内 RAM (内存)
        烧录为将文件实体被烧录到 STM32 的 Flash 中，被烧录文件称为可执行映像文件

    内核对象模型：
        RT-Thread 内核采用面向对象的设计思想进行设计，系统级的基础设施都是一种内核对象(eg:线程，信号量，互斥量)
            内核对象分为两类：静态内核对象和动态内核对象
            静态内核对象：在系统启动后在程序中初始化
            动态内核对象：从内存堆中创建，手工做初始化
            <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">/* 线程 1 的对象和运行时用到的栈 */</span><br><span class="line">static struct rt_thread thread1;           //定义静态结构体  线程1</span><br><span class="line">static rt_uint8_t thread1_stack[512];      //定义静态结构体  线程1 占用栈的大小为 512</span><br><span class="line">/* 线程 1 入口 */</span><br><span class="line">void thread1_entry(void* parameter)</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line"></span><br><span class="line">    while (1)</span><br><span class="line">    &#123;</span><br><span class="line">        for (i = 0; i &lt; 10; i ++)</span><br><span class="line">        &#123;</span><br><span class="line">            rt_kprintf(&quot;%d\n&quot;, i);</span><br><span class="line"></span><br><span class="line">            /* 延时 100ms */</span><br><span class="line">            rt_thread_mdelay(100);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 线程 2 入口 */</span><br><span class="line">void thread2_entry(void* parameter)</span><br><span class="line">&#123;</span><br><span class="line">    int count = 0;</span><br><span class="line">    while (1)</span><br><span class="line">    &#123;</span><br><span class="line">        rt_kprintf(&quot;Thread2 count:%d\n&quot;, ++count);</span><br><span class="line"></span><br><span class="line">        /* 延时 50ms */</span><br><span class="line">        rt_thread_mdelay(50);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 线程例程初始化 */</span><br><span class="line">int thread_sample_init()</span><br><span class="line">&#123;</span><br><span class="line">    rt_thread_t thread2_ptr;</span><br><span class="line">    rt_err_t result;</span><br><span class="line"></span><br><span class="line">    /* 初始化线程 1 */</span><br><span class="line">    /* 线程的入口是 thread1_entry，参数是 RT_NULL</span><br><span class="line">    * 线程栈是 thread1_stack</span><br><span class="line">    * 优先级是 200，时间片是 10 个 OS Tick</span><br><span class="line">    */</span><br><span class="line">    result = rt_thread_init(&amp;thread1,</span><br><span class="line">                            &quot;thread1&quot;,</span><br><span class="line">                            thread1_entry, RT_NULL,</span><br><span class="line">                            &amp;thread1_stack[0], sizeof(thread1_stack),</span><br><span class="line">                            200, 10);</span><br><span class="line"></span><br><span class="line">    /* 启动线程 */</span><br><span class="line">    if (result == RT_EOK) rt_thread_startup(&amp;thread1);</span><br><span class="line"></span><br><span class="line">    /* 创建线程 2 */</span><br><span class="line">    /* 线程的入口是 thread2_entry, 参数是 RT_NULL</span><br><span class="line">    * 栈空间是 512，优先级是 250，时间片是 25 个 OS Tick</span><br><span class="line">    */</span><br><span class="line">    thread2_ptr = rt_thread_create(&quot;thread2&quot;,</span><br><span class="line">                                thread2_entry, RT_NULL,</span><br><span class="line">                                512, 250, 25);</span><br><span class="line"></span><br><span class="line">    /* 启动线程 */</span><br><span class="line">    if (thread2_ptr != RT_NULL) rt_thread_startup(thread2_ptr);</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            thread1 是一个静态线程对象，thread2 是一个动态线程对象
                thread1 对象的内存空间，包括线程控制块 thread1 与栈空间 thread1_stack 都是编译时决定的，因为代码中都不存在初始值，都统一放在未初始化数据段中
                thread2 运行中用到的空间都是动态分配的，包括线程控制块（thread2_ptr 指向的内容）和栈空间
            &lt;静态对象会占用 RAM 空间，不依赖于内存堆管理器，内存分配时间确定。动态对象则依赖于内存堆管理器，运行时申请 RAM 空间，当对象被删除后，占用的 RAM 空间被释放&gt;
            
            RT-Thread 采用 内核对象 管理系统来访问 / 管理所有内核对象，内核对象包含了内核中绝大部分设施，这些内核对象可以是静态分配的静态对象，也可以是从系统内存堆中分配的动态对象。
            对象容器 中包含了每类内核对象的信息，包括对象类型，大小等
            对象容器 给每类内核对象分配了一个链表，所有的内核对象都被链接到该链表上

            对象控制块
            <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">内核对象控制块的数据结构：</span><br><span class="line">struct rt_object</span><br><span class="line">&#123;</span><br><span class="line">    /* 内核对象名称     */</span><br><span class="line">    char      name[RT_NAME_MAX];</span><br><span class="line">    /* 内核对象类型     */</span><br><span class="line">    rt_uint8_t  type;</span><br><span class="line">    /* 内核对象的参数   */</span><br><span class="line">    rt_uint8_t  flag;</span><br><span class="line">    /* 内核对象管理链表 */</span><br><span class="line">    rt_list_t   list;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">如果是静态对象，那么对象类型的最高位将是 1 , 否则是动态对象，系统最多能够容纳的对象类别数目是 127 个</span><br></pre></td></tr></table></figure>
            内核对象容器的数据结构：
            struct rt_object_information
            &#123;
                /* 对象类型 */
                enum rt_object_class_type type;
                /* 对象链表 */
                rt_list_t object_list;
                /* 对象大小 */
                rt_size_t object_size;
            &#125;;
            一类对象由一个 rt_object_information 结构体来管理，每一个这类对象的具体实例都通过链表的形式挂接在 object_list 上。而这一类对象的内存块尺寸由 object_size 标识出来（每一类对象的具体实例，他们占有的内存块大小都是相同的）
            <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">初始化对象</span><br></pre></td></tr></table></figure>
                在使用一个未初始化的静态对象前必须先对其进行初始化。初始化对象使用以下接口：
                void rt_object_init(struct  rt_object*  object ,
                            enum rt_object_class_type  type ,
                            const char* name)
                当调用这个函数进行对象初始化时，系统会把这个对象放置到对象容器中进行管理，即初始化对象的一些参数，然后把这个对象节点插入到对象容器的对象链表中
                <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">脱离对象</span><br></pre></td></tr></table></figure>
                从内核对象管理器中脱离一个对象。脱离对象使用以下接口：
                void rt_object_detach(rt_object_t object);
                调用该接口，可使得一个静态内核对象从内核对象容器中脱离出来，即从内核对象容器链表上删除相应的对象节点。对象脱离后，对象占用的内存并不会被释放。
                <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">分配对象</span><br></pre></td></tr></table></figure>
                上述描述的都是对象初始化、脱离的接口，都是面向对象内存块已经有的情况下，而动态的对象则可以在需要时申请，不需要时释放出内存空间给其他应用使用。申请分配新的对象可以使用以下接口：
                rt_object_t rt_object_allocate(enum  rt_object_class_type type ,
                                const  char*  name)
                <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除对象</span><br></pre></td></tr></table></figure>
                对于一个动态对象，当不再使用时，可以调用如下接口删除对象，并释放相应的系统资源:
                void rt_object_delete(rt_object_t object);
                <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">二. 线程管理</span><br><span class="line">        在 RT-Thread 中，与上述子任务对应的程序实体就是线程，线程是实现任务的载体，它是 RT-Thread 中最基本的调度单位，它描述了一个任务执行的运行环境，也描述了这个任务所处的优先等级，重要的任务可设置相对较高的优先级，非重要的任务可以设置较低的优先级，不同的任务还可以设置相同的优先级，轮流运行。</span><br><span class="line"></span><br><span class="line">        当线程运行时，它会认为自己是以独占 CPU 的方式在运行，线程执行时的运行环境称为上下文，具体来说就是各个变量和数据，包括所有的寄存器变量、堆栈、内存信息等。</span><br><span class="line"></span><br><span class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">·························································································</span><br><span class="line"></span><br><span class="line">            #include &quot;rtthread.h&quot;</span><br><span class="line">                            //线程栈</span><br><span class="line">            ALIGN (RT_ALIGN_SIZE)        //设置变量需要多少字节对齐，对在它下面的变量起作用   ALIGN 为一个带参宏</span><br><span class="line">            /* 线程栈 其实 就是一个预先定义好的全局数据，数据类型为uint8_t, 大小设置为512*/</span><br><span class="line">            rt_uint8_t rt_flag1_thread_stack[512];</span><br><span class="line">            rt_uint8_t rt_flag2_thread_stack[512];</span><br><span class="line"></span><br><span class="line">                            /*定义线程函数  -----&gt;   线程是一个独立的函数，主体无限循环且无返回   */</span><br><span class="line"></span><br><span class="line">            /*定义线程1*/</span><br><span class="line">            void flag1_thread_entry (void *arg)</span><br><span class="line">            &#123;</span><br><span class="line">                    for(;;)</span><br><span class="line">                    &#123;</span><br><span class="line">                    flag1 = 1;	</span><br><span class="line">                    delay(200);</span><br><span class="line">                    flag1 =0;</span><br><span class="line">                    delay(200);</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            /*定义线程2*/</span><br><span class="line">            void flag2_thread_entry (void *arg)</span><br><span class="line">            &#123;</span><br><span class="line">                    for(;;)</span><br><span class="line">                    &#123;</span><br><span class="line">                    flag2 = 1;	</span><br><span class="line">                    delay(200);</span><br><span class="line">                    flag2 =0;</span><br><span class="line">                    delay(200);</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            /*定义线程控制块   </span><br><span class="line">                            在多线程系统中，线程的执行由系统调度的， &lt;为了线程调度成功，为每个线程额外定义了一个线程控制块&gt;--【相当于线程的身份证】</span><br><span class="line">                            线程控制块里存有线程的所有信息： 线程的栈指针，线程栈的起始地址，线程栈的大小，线程名称【即为---&gt;线程入口地址】，线程形参【即为---&gt;线程参数的入口地址】</span><br><span class="line"></span><br><span class="line">            struct rt_thread</span><br><span class="line">            &#123;</span><br><span class="line">                void *sp;         				//线程的栈指针</span><br><span class="line">                void *entry;		  				//线程入口地址</span><br><span class="line">                void *parameter;					//线程参数的入口地址</span><br><span class="line">                void *stack_addr; 				//线程栈的起始地址</span><br><span class="line">                rt_uint32_t stack_size;		//线程栈的大小</span><br><span class="line"></span><br><span class="line">                rt_list_t  tlist           //线程链表节点</span><br><span class="line">            &#125;;</span><br><span class="line">            typedef struct rt_thread *rt_thread_t;          //给新声明的结构体数据类型重新定义一个指针</span><br><span class="line"></span><br><span class="line">            */</span><br><span class="line">            /*线程控制块定义*/</span><br><span class="line">            struct rt_thread rt_flag1_thread;</span><br><span class="line">            struct rt_thread rt_flag2_thread;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            /*线程的栈，线程的函数主体，线程控制块   -----&gt;  联系起来才能由系统进行调度*/</span><br><span class="line">            /*联系  的工作由  线程的创建来实现*/</span><br><span class="line">            /*</span><br><span class="line">            实现线程  创建函数</span><br><span class="line">                    分为： 静态创建   和   动态创建</span><br><span class="line">                    静态创建：rt_thread_init();</span><br><span class="line">                    动态创建：rt_thread_creat();</span><br><span class="line">            */</span><br><span class="line"></span><br><span class="line">            /*静态创建___ 1*/</span><br><span class="line">            rt_err_t rt_thread_init(</span><br><span class="line">                                                            struct rt_thread *thread,</span><br><span class="line">                                                            void (*entry)(void *parameter),</span><br><span class="line">                                                            void *parameter,</span><br><span class="line">                                                            void *stack_start,	</span><br><span class="line">                                                            rt_uint32_t stack_size</span><br><span class="line">                                                        )</span><br><span class="line">            &#123;</span><br><span class="line">                rt_list_init(&amp;(thread-&gt;tlist));     //初始化线程链表节点 （之后只需把线程插入到各种链表中，就是通过这个节点实现），可把线程控制块挂在各种链表中</span><br><span class="line">                /*</span><br><span class="line">                struct rt_list_node</span><br><span class="line">                &#123;</span><br><span class="line">                    struct rt_list_node *next;        //指向后一个节点</span><br><span class="line">                    struct rt_list_node *prev;				//指向前一个节点</span><br><span class="line">                &#125;</span><br><span class="line">                */</span><br><span class="line">                thread-&gt;entry = (void *)entry;          </span><br><span class="line">                thread-&gt;parameter = parameter;</span><br><span class="line">                thread-&gt;stack_addr = stack_start;</span><br><span class="line">                thread-&gt;stack_size = stack_size;</span><br><span class="line">                </span><br><span class="line">                //初始化线程栈，并返回线程栈指针</span><br><span class="line">                thread-&gt;sp = </span><br><span class="line">                (void *)rt_hw_stack_init( thread -&gt; entry,</span><br><span class="line">                                                                    thread -&gt; parameter,</span><br><span class="line">                (void *)((char *)thread -&gt; stack_addr + thread -&gt; stack_size -4));</span><br><span class="line">                return RT_EOK;</span><br><span class="line">            &#125;</span><br><span class="line">                </span><br><span class="line">                /*</span><br><span class="line">            *	初始化链表节点 [自己的前一个节点和后一个节点都指向自己--&gt; 自己指自己]</span><br><span class="line">                rt_inline  void rt_list_init (rt_list_t *l)</span><br><span class="line">                &#123;</span><br><span class="line">                l-&gt;next = l-&gt;prev = l;</span><br><span class="line">                &#125;	</span><br><span class="line">            * 在双向链表中插入节点</span><br><span class="line">                        在链表后插入一个节点:</span><br><span class="line">                        rt_inline  void rt_list_insert_after (rt_list_t *l, rt_list_t *n)</span><br><span class="line">                        &#123;</span><br><span class="line">                        l-&gt;next -&gt;prev = n;</span><br><span class="line">                        n-&gt;next = l-&gt;next;</span><br><span class="line">                        l-&gt;next = n;</span><br><span class="line">                        n-&gt;prev = l;</span><br><span class="line">                        &#125;	  </span><br><span class="line">                        在链表前插入一个节点:</span><br><span class="line">                        rt_inline  void rt_list_insert_before (rt_list_t *l, rt_list_t *n)</span><br><span class="line">                        &#123;</span><br><span class="line">                        l-&gt;prev -&gt;next = n;</span><br><span class="line">                        n-&gt;prev = l-&gt;prev;</span><br><span class="line">                        l-&gt;prev = n;</span><br><span class="line">                        n-&gt;next = l;</span><br><span class="line">                        &#125;</span><br><span class="line">            *	删除一个节点:</span><br><span class="line">                        rt_inline  void rt_list_remove(rt_list_t *n)</span><br><span class="line">                        &#123;</span><br><span class="line">                            n-&gt;next-&gt;prev = n-&gt;prev;</span><br><span class="line">                            n-&gt;prev-&gt;next = n-&gt;next;</span><br><span class="line">                            n-&gt;next = n-&gt;prev = n;</span><br><span class="line">                        &#125;</span><br><span class="line">                */</span><br><span class="line"></span><br><span class="line">                /*</span><br><span class="line">                就绪列表:</span><br><span class="line">                线程创建好后，需要把线程添加到就绪列表中，即系统就知道线程已经就绪，随时可以调度</span><br><span class="line">                </span><br><span class="line">                添加有两种方式: 定义就绪列表    和    将线程插入到就绪列表</span><br><span class="line">                */</span><br><span class="line">                /*定义就绪列表*/</span><br><span class="line">                rt_list_t rt_thread_prority_table [RT_THREAD_PRORITY_MAX];   //数组下标对应了线程的优先级，同一优先级统一插入到就绪列表的同一条链表上</span><br><span class="line">                /*插入到就绪列表*/</span><br><span class="line">            /*数据控制块里有个tlist成员，数据类型为rt_list_t,我们将线程插入就绪列表里，就是通过tlist这个节点来插入到就绪列表中来实现*/</span><br><span class="line">                rt_list_insert_before( &amp;(rt_thread_prority_table[0]),&amp;(rt_flag1_thread..tlist));   //将flag1线程插入到就绪列表下标为0的链表中</span><br><span class="line">                </span><br><span class="line">            /************实现调度器************/</span><br><span class="line">            /*调度器: 操作系统的核心，实现线程的切换【从就绪列表中找到优先级高的线程，然后去执行该线程】</span><br><span class="line">            /*调度器初始化*/</span><br><span class="line">            void rt_system_scheduler_init (void)</span><br><span class="line">            &#123;</span><br><span class="line">                register rt_base_t offset;               //定义一个局部变量，register修饰，防止被编译器优化</span><br><span class="line">                for (offset=0; offset&lt;RT_THREAD_PRORITY_MAX; offset++)</span><br><span class="line">                &#123;</span><br><span class="line">                    rt_list_init(&amp;rt_thread_prority_table[offset] );         //线程就绪列表初始化</span><br><span class="line">                &#125;</span><br><span class="line">                rt_current_thread = RT_NULL;         //初始化当前线程控制块指针为空  ， rt_current_thread用于指向当前正在运行的线程的线程控制块</span><br><span class="line">            &#125;</span><br><span class="line">            /*启动调度器*/</span><br><span class="line">            void rt_system_scheduler_start (void)</span><br><span class="line">            &#123;</span><br><span class="line">                register struct rt_thread *to_thread;</span><br><span class="line">                /*手动指定第一个运行的线程*/</span><br><span class="line">                to_thread = rt_list_entry ( rt_thread_priority_table[0].next , </span><br><span class="line">                                                                        struct rt_thread,</span><br><span class="line">                                                                        tlist</span><br><span class="line">                                                                    );</span><br><span class="line">                rt_current_thread = to_thread;														</span><br><span class="line">                rt_hw_context_switch_to ((rt_uint32_t)&amp;to_thread-&gt;sp);</span><br><span class="line">            &#125;</span><br><span class="line">            /*已知一个结构体里面的成员的地址，反推出该结构体的首地址*/</span><br><span class="line">            /*</span><br><span class="line">            #define rt_container_of (ptr, type, member) \</span><br><span class="line">                        ((type*)((char*)(ptr)- (unsigned long) (&amp;((type*)0)-&gt;member)))</span><br><span class="line">            #define rt_list_entry (node, type, member)  \</span><br><span class="line">                        rt_container_of (ptr, type, member)</span><br><span class="line"></span><br><span class="line">            // 将0地址强制转换为首地址，然后通过指针访问结构体成员的方法获取偏移量的大小，最后即可推算出结构体的首地址</span><br><span class="line">            */</span><br><span class="line">            PendSV_Handler() //真正实现线程上下文切换的函数</span><br><span class="line"></span><br><span class="line">            /*对象: 在RTT中，所有的数据结构都是对象*/</span><br><span class="line">            /*在rtt中，为了方便管理这些对象，专门定义了一个对象类型的数据结构*/</span><br><span class="line">            struct rt_object</span><br><span class="line">            &#123;</span><br><span class="line">                char   name[RT_NAME_MAX];        //内核对象的名字</span><br><span class="line">                rt_uint8_t type;                 //内核对象的类型</span><br><span class="line">                rt_uint8_t flag;                 //内核对象的状态</span><br><span class="line">                </span><br><span class="line">                rt_list_t  list;                 //内核对象的列表节点</span><br><span class="line">            &#125;;</span><br><span class="line">            typedef struct rt_object *rt_object_t;        //内核对象的数据类型重定义</span><br><span class="line">            /*</span><br><span class="line">            在RT-Thread中，每个对象都会有一个对应的结构体，这个结构体叫做  【该对象的控制块】</span><br><span class="line">                eg:  线程---&gt;线程控制块      定时器---&gt;定时器控制块       信号量---&gt;信号量控制块</span><br><span class="line">            这些控制块的开头都包含一个【内核对象结构体】或者 直接将【对象结构体的成员】放在【对象控制块结构体的开头】</span><br><span class="line">                        //线程控制块  添加的是  对象结构体的成员</span><br><span class="line">                        //其余都是直接加    内核对象结构体   的   内核对象变量</span><br><span class="line">                struct rt_thread&#123;</span><br><span class="line">                    char    name[RT_NAME_MAX];       //对象的名字</span><br><span class="line">                    rt_uint8_t  type;                //对象类型</span><br><span class="line">                    rt_uint8_t  flags;               //对象的状态 </span><br><span class="line">                    rt_list_t   list;                //对象的列表节点</span><br><span class="line"></span><br><span class="line">                    rt_list_t   tlist;               //线程链表节点</span><br><span class="line">                    .................                //下面为关于线程的</span><br><span class="line">            &#125;</span><br><span class="line">            */</span><br><span class="line">            /*</span><br><span class="line">            容器:</span><br><span class="line">            在rtt中，每创建一个对象，就会把这个对象放到一个叫 容器的地方  -----&gt;  方便管理</span><br><span class="line">            通过扫描容器的内核对象来获取各个对象的状态，然后输出调试信息</span><br><span class="line">                    【容器就是一个数组，是一个全局变量，数据类型为结构体类型，包含：对象类型、对象列表节点头（每当创建对象，对象会通过控制块里的list节点将自己挂载到容器的对应列表，同一类型的对象挂载到同一列表中）、对象的大小】</span><br><span class="line">            对象初始化：</span><br><span class="line">                    1.将对象控制块里面与对象的相关成员初始化    // rt_object_init(struct rt_object   *object,</span><br><span class="line">                                                                                                                                                enum rt_object_class_type  type,	</span><br><span class="line">                                                                                                                                                const  char         *name</span><br><span class="line">                                                                                                                                                );   </span><br><span class="line">                    2.将对象插入到对象容器中（调用）            // rt_object_init(.....);放到线程初始化中即调用</span><br><span class="line">            */</span><br><span class="line">            /*</span><br><span class="line">            RTOS 的优势就是压榨CPU</span><br><span class="line">                RTOS的延时为  堵塞延时  （不能让CPU空等延时，此时则让出CPU的使用，CPU可干其余的事情），延时时间到后重新获取CPU的使用权</span><br><span class="line">                若CPU 堵塞延时，又没有其余的线程的时候，则RTOS会创建一个空闲线程，让CPU跑空闲线程[空闲线程为创建的优先级最低的线程，主要做一些系统内存的清理工作]</span><br><span class="line">            */</span><br><span class="line">            /*实现空闲线程*/</span><br><span class="line">            /*	1.定义空闲线程的栈</span><br><span class="line">                2.定义空闲线程的线程控制块</span><br><span class="line">                3.定义空闲线程函数</span><br><span class="line">                4.空闲线程初始化</span><br><span class="line">            */</span><br><span class="line">            /*SysTick_Handler 中断服务函数   */</span><br><span class="line">            /*</span><br><span class="line">                在系统调度函数rt_schedule()中，会判断 【每个线程的线程控制块】  中的【延时成员remaining_tick的值是否为0】，为0则将对应的线程就绪，否则继续延时</span><br><span class="line">            remaining_tick  以 SysTick  中断周期递减 </span><br><span class="line">                </span><br><span class="line">            首先：关中断:  rt_hw_interrupt_disable(); </span><br><span class="line">            然后：中断频率设置: SysTick_Config( Systemcoreclock / RT_TICK_PER_SECOND );</span><br><span class="line">            */</span><br><span class="line">            /*</span><br><span class="line">            RT-Thread中, 优先级的切换  靠 【线程优先表  和   线程就绪优先级组】</span><br><span class="line">                    线程就绪优先级组:快速找到线程在线程优先表对应优先级表的插入/删除的位置 </span><br><span class="line">                    线程优先表: 为一个双向链表，当线程就绪时，线程会根据优先级插入到对应索引的链表【即为线程优先表】，同一优先级的线程都会被插入到同一条链表中</span><br><span class="line">            线程插入到线程优先级表【即为线程插入调度器】： rt_schedule_insert_thread(struct rt_thread  *thread)</span><br><span class="line">            线程优先级表删除线程  【即为调度器删除线程】： rt_schedule_remove_thread(struct rt_thread  *thread)</span><br><span class="line">            &lt;&lt;&lt;&lt;&lt;创建好的线程 用 调用函数rt_thread_startup() 来实现将线程启动  [之前用rt_list_insert_before()来将线程插入到优先级列表中]&gt;&gt;&gt;&gt;&gt;</span><br><span class="line">            */</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            /*</span><br><span class="line">            定时器：</span><br><span class="line">            rtt内部中，每个线程内部都内置一个定时器，当线程需要延时的时候，则先将线程挂起，然后内置定时器启动，并将定时器插入到一个全局的系统定时器列表rt_timer_list中</span><br><span class="line">            &lt;&lt;全局的系统定时器维护着一条双向链表，每个节点都代表一个正在延时的线程定时器，节点按照延时时间的大小升序排列---&gt; 当时基中断来临时，就扫描第一个定时器，若延时时间不到，则退出扫描【第一个定时器不到，之后的也肯定不到，按升序排列的】&gt;&gt;</span><br><span class="line">            ***延时结束后，只是将线程变为就绪状态，仍需要调度器去调度才能启动</span><br><span class="line">            定时器初始化函数：rt_timer_init();</span><br><span class="line">            定时器删除函数：  rt_timer_remove();</span><br><span class="line">            定时器停止函数：  rt_timer_stop();   //先将定时器从系统定时器列表中删除，然后改变定时器的状态为  非active</span><br><span class="line">            定时器控制函数：  rt_timer_control();   //设置定时器的状态和初始时间值</span><br><span class="line">            定时器启动函数：  rt_timer_start();     //将定时器按照延时时间做升序排列，并插入到系统定时器列表中</span><br><span class="line">            定时器扫描函数：  rt_timer_check();     //用于扫描系统定时器列表，查询定时器的延时是否到期，若到期则让对应线程就绪</span><br><span class="line">            */</span><br><span class="line">            /*</span><br><span class="line">            时间片用于同一优先级下，时间片的时间到后，会让此线程从就绪列表中让出，变为挂起态</span><br><span class="line">            对只有一个优先级的，时间片没有作用</span><br><span class="line">            */</span><br><span class="line"></span><br><span class="line">·························································································</span><br><span class="line">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line"></span><br><span class="line">        动态内存堆的使用</span><br><span class="line">            栈(stack)：由编译器自动分配释放</span><br><span class="line">            堆(heap) ：由程序员分配和释放</span><br><span class="line"></span><br></pre></td></tr></table></figure>
        启动文件：(汇编)    
            Stack_Size      EQU     0x400;
                            AREA    STACK, NOINIT, READWRITE, ALIGN=3
            Stack_Mem       SPACE   Stack_Size
            __initial_sp

            Heap_Size       EQU     0x200;
                            AREA    HEAP, NOINIT, READWRITE, ALIGN=3
            __heap_base
            Heap_Mem        SPACE   Heap_Size
            __heap_limit
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</code></pre>

      <div class="tags">
          <a href="/tags/RT-thread/" rel="tag"><i class="ic i-tag"></i> RT-thread</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2021-07-25 21:51:07" itemprop="dateModified" datetime="2021-07-25T21:51:07+08:00">2021-07-25</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="~元~ WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="~元~ Alipay">
        <p>Alipay</p>
      </div>
      
      <div>
        <img data-src="/images/paypal.png" alt="~元~ PayPal">
        <p>PayPal</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>~元~ <i class="ic i-at"><em>@</em></i>天元の
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/RT-thread__1/" title="RT-thread__1">https://github.com/yuanyiyuan/yuanyiyuan.github.io.git/RT-thread__1/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/C%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%BF%9B%E9%98%B6/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclh0m9pdj20zk0m8hdt.jpg" title="C语言之进阶">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>C语言之进阶</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/RT-thread__2/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeuibk9fj20zk0m8ay2.jpg" title="RT-thread__2">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>RT-thread__2</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="~元~"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">~元~</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">11</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">5</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <a href="https://github.com/yuanyiyuan" title="https:&#x2F;&#x2F;github.com&#x2F;yuanyiyuan" class="item github"><i class="ic i-github"></i></a>
      <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTE5ODc4NTU1NDQ=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1987855544"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>links</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/C%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%BF%9B%E9%98%B6/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/RT-thread__2/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/OpenMv%E7%AC%94%E8%AE%B0/" title="OpenMv笔记">OpenMv笔记</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/hello-world/" title="Hello World">Hello World</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/C%E8%AF%AD%E8%A8%80%E4%B9%8B%E8%BF%9B%E9%98%B6/" title="C语言之进阶">C语言之进阶</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/arduino%E7%AC%94%E8%AE%B0/" title="arduino常见的库及其使用">arduino常见的库及其使用</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/HAL/" title="HAL">HAL</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/Vscode%20quick/" title="VScode 快捷键">VScode 快捷键</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/LINUX%E7%AF%87/" title="LINUX篇">LINUX篇</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/C%E8%AF%AD%E8%A8%80/" title="C语言">C语言</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/RT-thread__1/" title="RT-thread__1">RT-thread__1</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/STM32CubeMx%E7%A7%BB%E6%A4%8Dfinsh%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/" title="STM32CubeMx移植RT-Thread的RTOS和finsh步骤和解决办法">STM32CubeMx移植RT-Thread的RTOS和finsh步骤和解决办法</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2020 – 
    <span itemprop="copyrightYear">2021</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">~元~ @ Tian yuan</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka">Shoka</a>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'RT-thread__1/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
